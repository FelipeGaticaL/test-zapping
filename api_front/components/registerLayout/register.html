<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Video</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css"
      />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
      crossorigin="anonymous"
      />
    <link href="
      https://cdn.jsdelivr.net/npm/sweetalert2@11.7.1/dist/sweetalert2.min.css
      " rel="stylesheet"/>
    <!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
      />
    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
      rel="stylesheet"
      />
    <!-- MDB -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.1.0/mdb.min.css"
      rel="stylesheet"
      />

    <link rel="stylesheet" href="./style.css" />
  </head>

  <body>
    <div class="box">
      <div class="wave -one"></div>f
      <div class="wave -two"></div>
      <div class="wave -three"></div>
    </div>
    <div class="container d-flex justify-content-center" style="height:
      106rem;">
      <div class="h-auto ">
        <section class="vh-100" style="background-color: #eee;">
          <div class="container h-100">
            <div class="row d-flex justify-content-center align-items-center
              h-100">
              <div class="col-lg-12 col-xl-11">
                <div class="card text-black h-50" style="border-radius: 25px;">
                  <div class="card-body p-md-5">
                    <div class="row justify-content-center">
                      <div class="col-md-10 col-lg-6 col-xl-5 order-2
                        order-lg-1">

                        <p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4
                          mt-4">Registrate</p>

                        <form onsubmit="register(event)" class="mx-1 mx-md-4">
                          <div class="d-flex flex-row align-items-center mb-4">
                            <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                            <div class="form-outline flex-fill mb-0">
                              <input type="text" id="name" name="name"
                                class="form-control" />
                              <label class="form-label fw-light" for="name">Nombre</label>
                            </div>
                          </div>

                          <div class="d-flex flex-row align-items-center mb-4">
                            <i class="fas fa-envelope fa-lg me-3 fa-fw"></i>
                            <div class="form-outline flex-fill mb-0">
                              <input type="email" id="mail" name="mail"
                                class="form-control" />
                              <label class="form-label fw-light" for="mail">Mail</label>
                            </div>
                          </div>

                          <div class="d-flex flex-row align-items-center mb-4">
                            <i class="fas fa-lock fa-lg me-3 fa-fw"></i>
                            <div class="form-outline flex-fill mb-0">
                              <input type="password" id="password"
                                name="password" class="form-control" />
                              <label class="form-label fw-light" for="password">Contraseña</label>
                            </div>
                          </div>

                          <div class="d-flex flex-roFw align-items-center mb-4
                            ">
                            <i class="fas fa-key fa-lg me-3 fa-fw"></i>
                            <div class="form-outline flex-fill mb-0 ">
                              <input type="password" id="repeat_password"
                                name="repeat_password" class="form-control" />
                              <label class="form-label fw-light"
                                for="repeat_password">Repite tu contraseña</label>
                            </div>
                          </div>


                          <div class="d-flex justify-content-center mx-4 mb-3
                            mb-lg-4">

                            <button class="btn btn-primary btn-lg">Registrar</button>
                          </div>

                        </form>

                      </div>
                      <div class="col-md-10 col-lg-6 col-xl-7 d-flex
                        align-items-center order-1 order-lg-2">

                        <img data-mdb-toggle="animation" data-mdb-animation-reset="true" data-mdb-animation="tada" src="https://svgsilh.com/svg/297306-e91e63.svg"
                          class="img-fluid" alt="Sample image">

                      </div>
                      
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

      </div>
    </div>

    <!-- MDB -->
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.1.0/mdb.min.js"></script>
    <!-- Bootstrap CSS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
      crossorigin="anonymous"></script>
    <script src="https://unpkg.com/axios@1.1.2/dist/axios.min.js"></script>
    <script src="
      https://cdn.jsdelivr.net/npm/sweetalert2@11.7.1/dist/sweetalert2.all.min.js
      "></script>
    <script>
       async function register(event) {
                event.preventDefault();
                var name = document.getElementById("name").value;
                var mail = document.getElementById("mail").value;
                var password = document.getElementById("password").value;
                var repeat_password = document.getElementById("repeat_password").value;
                let arrayData = {"name": name, "mail" : mail, "password" :password}
                if(password != repeat_password){
                    Swal.fire({
                            title: 'Erro de Contraseña',
                            text: 'No coinciden las contraseñas',
                            icon: 'error'
                        })
                     } else if(!name || !mail || !password || !repeat_password){
                      Swal.fire({
                            title: 'Faltan datos',
                            text: 'Debes completar todos los campos',
                            icon: 'error'
                        })

                     } else{
                          try {       
                              const { status } = await axios.post('/api/auth/register', arrayData)
                                 
                              if (status === 200) {
                                  Swal.fire({
                                      title: 'Registro exitoso',
                                      text: 'Ahora puedes iniciar sesión',
                                      icon: 'success'
                                  }).then(() => {
                                      window.location.href = '/';
                                  });
                              } else if(!status || status != 200){
                                Swal.fire({
                                  title: 'Error',
                                  text: 'Usuarion no Existe',
                                  icon: 'error'
                              });

                              }
                          } catch (error) {
                              Swal.fire({
                                  title: 'Error',
                                  text: error.response.data,
                                  icon: 'error'
                              });
                          }

                     }
            }

            
    </script>
  </body>
</html>
